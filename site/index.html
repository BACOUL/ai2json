<!DOCTYPE html>
<html lang="en" id="top">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
  <meta name="color-scheme" content="dark light">
  <title>AI2JSON — Web → JSON for AI Reading</title>
  <meta name="description" content="AI2JSON converts any public webpage into clean, structured JSON so LLMs and RAG pipelines can read content without HTML noise. Free public sandbox. No API key.">
  <meta name="referrer" content="strict-origin-when-cross-origin">
  <style>
    :root{
      color-scheme:dark light;
      --bg:#020313;
      --bg-alt:#050821;
      --fg:#f7f7fb;
      --fg-soft:#9ea3c0;
      --fg-softer:#6e7390;
      --accent:#4f7cff;
      --accent-soft:rgba(79,124,255,.18);
      --accent-strong:#76e4ff;
      --border:#272b45;
      --border-soft:#151729;
      --radius-lg:18px;
      --radius-md:12px;
      --shadow-soft:0 26px 60px rgba(0,0,0,.72);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:system-ui,-apple-system,BlinkMacSystemFont,"SF Pro Text",sans-serif;
      background:
        radial-gradient(circle at 0% -10%, #1b2b68 0, transparent 55%),
        radial-gradient(circle at 100% 0%, #321b68 0, transparent 55%),
        linear-gradient(180deg, #020313 0, #050817 55%, #020313 100%);
      color:var(--fg);
      -webkit-font-smoothing:antialiased;
    }
    a{color:var(--accent);text-decoration:none}
    a:hover{text-decoration:underline}
    .page{max-width:1100px;margin:0 auto;padding:22px 18px 76px}

    header{
      display:flex;align-items:center;justify-content:space-between;gap:16px;
      margin-bottom:30px;
    }
    .brand{display:flex;align-items:center;gap:12px}
    .logo-orb{
      width:34px;height:34px;border-radius:999px;
      background:conic-gradient(from 170deg,#4f7cff,#86e3ff,#c19bff,#4f7cff);
      position:relative;
      box-shadow:0 0 0 2px #020313,0 18px 32px rgba(0,0,0,.65);
      display:inline-flex;align-items:center;justify-content:center;
      font-weight:800;font-size:15px;color:#fff;letter-spacing:.06em;
    }
    .logo-orb::after{
      content:"";position:absolute;inset:3px;border-radius:inherit;
      background:radial-gradient(circle at 30% 10%, rgba(255,255,255,.45), transparent 55%);
      mix-blend-mode:screen;
    }
    .logo-orb span{position:relative;z-index:1}
    .logo-text-main{font-weight:650;font-size:15px;letter-spacing:.08em;text-transform:uppercase}
    .logo-text-sub{font-size:11px;color:var(--fg-soft)}
    nav{display:flex;align-items:center;gap:16px;font-size:13px;flex-wrap:wrap;justify-content:flex-end}
    nav a{color:var(--fg-soft)}
    nav a:hover{color:var(--fg)}
    .nav-cta{
      padding:8px 14px;border-radius:999px;
      border:1px solid rgba(255,255,255,.12);
      background:radial-gradient(circle at 0 0, rgba(118,228,255,.14), transparent 55%);
      display:inline-flex;align-items:center;gap:7px;
      font-size:12px;font-weight:650;color:var(--fg);
    }
    .nav-cta span.dot{
      width:7px;height:7px;border-radius:999px;background:#2cf5aa;
      box-shadow:0 0 0 4px rgba(44,245,170,.2);
    }
    @media (max-width:860px){
      header{flex-direction:column;align-items:flex-start}
      nav{justify-content:flex-start}
    }

    main{
      display:grid;
      grid-template-columns:minmax(0, 1.25fr) minmax(0, 1.15fr);
      gap:26px;
      align-items:flex-start;
    }
    @media (max-width:980px){
      main{grid-template-columns:minmax(0,1fr)}
    }

    .eyebrow-row{display:flex;flex-wrap:wrap;gap:10px;margin-bottom:12px}
    .eyebrow{
      display:inline-flex;align-items:center;gap:8px;
      padding:4px 11px;border-radius:999px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(2,3,19,.8);
      font-size:11px;letter-spacing:.12em;text-transform:uppercase;
      color:var(--fg-soft);
    }
    .eyebrow-badge{
      padding:3px 9px;border-radius:999px;
      background:var(--accent-soft);
      color:#dde5ff;letter-spacing:0;text-transform:none;font-weight:650;
    }

    h1{margin:0 0 12px;font-size:clamp(32px,4.6vw,46px);line-height:1.05}
    h1 .highlight{
      background-image:linear-gradient(120deg,#76e4ff,#c19bff);
      -webkit-background-clip:text;background-clip:text;color:transparent;
    }
    .lead{
      font-size:15px;line-height:1.65;color:var(--fg-soft);
      max-width:720px;margin:0 0 16px;
    }
    .lead b{color:var(--fg)}
    .hero-pills{display:flex;flex-wrap:wrap;gap:8px;margin:0 0 18px}
    .pill{
      padding:4px 10px;border-radius:999px;
      border:1px solid var(--border);
      background:rgba(6,8,29,.9);
      font-size:11px;color:var(--fg-soft);
      display:inline-flex;align-items:center;gap:6px;
    }
    .pill-dot{width:6px;height:6px;border-radius:999px;background:var(--accent-strong)}
    .cta-row{display:flex;flex-wrap:wrap;gap:10px;align-items:center;margin:0 0 10px}
    .btn{
      display:inline-flex;align-items:center;justify-content:center;
      padding:9px 18px;border-radius:999px;border:0;
      font-size:13px;font-weight:800;cursor:pointer;
      background:linear-gradient(135deg,#4f7cff,#76e4ff);
      color:#020313;text-decoration:none;
      box-shadow:0 14px 30px rgba(0,0,0,.6);
    }
    .btn-outline{
      display:inline-flex;align-items:center;justify-content:center;
      padding:8px 16px;border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      font-size:13px;color:var(--fg);background:rgba(4,6,25,.7);
      text-decoration:none;
    }
    .hero-note{
      font-size:11px;color:var(--fg-softer);
      display:flex;flex-wrap:wrap;gap:6px;margin-top:6px;
    }
    .hero-note span{
      padding:3px 8px;border-radius:999px;
      border:1px solid rgba(255,255,255,.08);
      background:rgba(2,4,19,.9);
    }

    .hero-panel{
      border-radius:22px;
      border:1px solid rgba(112,136,255,.3);
      background:
        radial-gradient(circle at 0 0, rgba(118,228,255,.18), transparent 60%),
        radial-gradient(circle at 100% 0, rgba(83,124,255,.22), transparent 65%),
        linear-gradient(145deg,#050821,#020313);
      padding:14px 16px 16px;
      box-shadow:var(--shadow-soft);
      font-size:13px;
      position:relative;
      overflow:hidden;
    }
    .hero-panel::before{
      content:"LIVE SANDBOX";
      position:absolute;right:16px;top:12px;
      font-size:9px;text-transform:uppercase;letter-spacing:.16em;
      color:rgba(223,230,255,.45);
    }
    .panel-title{
      font-size:12px;text-transform:uppercase;letter-spacing:.16em;
      color:var(--fg-soft);margin:0 0 10px;
    }

    .field{display:flex;gap:10px;align-items:center;margin-bottom:10px}
    .input{
      width:100%;
      padding:10px 12px;border-radius:12px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(2,4,18,.55);
      color:var(--fg);
      outline:none;
      font-size:13px;
    }
    .input::placeholder{color:rgba(158,163,192,.7)}
    .small-btn{
      padding:10px 14px;border-radius:12px;border:0;
      background:linear-gradient(135deg,#4f7cff,#76e4ff);
      color:#020313;font-weight:900;cursor:pointer;
      white-space:nowrap;
    }
    .small-btn[disabled]{opacity:.55;cursor:not-allowed}
    .mini-row{display:flex;flex-wrap:wrap;gap:8px;margin:0 0 10px}
    .mini{
      font-size:11px;color:var(--fg-soft);
      padding:4px 9px;border-radius:999px;
      border:1px solid rgba(255,255,255,.08);
      background:rgba(2,4,19,.65);
    }

    .tabs{
      display:flex;gap:6px;flex-wrap:wrap;margin:0 0 10px
    }
    .tab{
      font-size:11px;
      padding:6px 10px;border-radius:999px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(2,4,19,.6);
      color:var(--fg-soft);
      cursor:pointer;
      user-select:none;
    }
    .tab[aria-selected="true"]{
      background:rgba(255,255,255,.10);
      color:var(--fg);
      border-color:rgba(255,255,255,.14);
    }

    .code-window{
      border-radius:14px;
      border:1px solid rgba(26,33,68,.95);
      background:radial-gradient(circle at 10% 0,#161c3e,#050821);
      padding:9px 10px 10px;
      font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;
      font-size:11px;color:#dde3ff;
      overflow-x:auto;
      white-space:pre;
      line-height:1.5;
      margin:0 0 10px;
      min-height:180px;
    }
    .code-window-header{
      display:flex;align-items:center;justify-content:space-between;
      margin-bottom:6px;font-size:10px;color:var(--fg-softer);
    }
    .dots{display:inline-flex;gap:4px}
    .dot{width:7px;height:7px;border-radius:999px;background:#ff5f57}
    .dot:nth-child(2){background:#febc2e}
    .dot:nth-child(3){background:#28c840}
    .code-pill{border-radius:999px;border:1px solid rgba(255,255,255,.12);padding:2px 7px}
    .panel-footer{font-size:11px;color:var(--fg-soft)}
    .panel-footer b{color:var(--fg)}

    section{margin-top:44px}
    .section-kicker{font-size:11px;text-transform:uppercase;letter-spacing:.16em;color:var(--fg-soft);margin-bottom:6px}
    h2.section-title{font-size:20px;margin:0 0 8px}
    .section-sub{font-size:13px;color:var(--fg-soft);max-width:820px;margin:0 0 16px}
    .section-sub b{color:var(--fg)}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(230px,1fr));gap:16px}
    .feature{
      border-radius:var(--radius-lg);
      border:1px solid var(--border-soft);
      padding:13px 14px 15px;
      background:radial-gradient(circle at 0 0, rgba(118,228,255,.08), transparent 70%), rgba(5,8,28,.96);
      font-size:13px;
    }
    .feature h3{margin:0 0 6px;font-size:13px}
    .feature p{margin:0;font-size:12px;line-height:1.6;color:var(--fg-soft)}
    .feature code{font-size:11px}

    .table-wrap{
      border-radius:var(--radius-lg);
      border:1px solid var(--border-soft);
      overflow:hidden;
      background:rgba(5,8,30,.97);
    }
    .table{width:100%;border-collapse:collapse;font-size:12px}
    .table th,.table td{padding:7px 10px;text-align:left;border-bottom:1px solid rgba(32,36,66,.9)}
    .table th{
      font-size:11px;color:var(--fg-soft);
      text-transform:uppercase;letter-spacing:.12em;
      background:rgba(10,13,40,.85);
    }
    .table tr:last-child td{border-bottom:none}
    .table code{font-size:11px}

    .mono-block{
      font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;
      font-size:11px;
      background:#050814;
      border-radius:var(--radius-md);
      border:1px solid #222845;
      padding:10px 11px;
      overflow-x:auto;
      white-space:pre;
      line-height:1.5;
    }

    .compare{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:16px;
      align-items:start;
    }
    @media (max-width:980px){
      .compare{grid-template-columns:1fr}
    }
    .compare-card{
      border-radius:var(--radius-lg);
      border:1px solid var(--border-soft);
      background:rgba(5,8,28,.96);
      padding:12px 12px 14px;
    }
    .compare-title{
      display:flex;justify-content:space-between;gap:10px;align-items:center;margin:0 0 8px
    }
    .compare-title b{font-size:12px;letter-spacing:.10em;text-transform:uppercase;color:var(--fg)}
    .compare-title span{
      font-size:11px;color:var(--fg-soft);
      padding:3px 8px;border-radius:999px;
      border:1px solid rgba(255,255,255,.08);
      background:rgba(2,4,19,.65);
      white-space:nowrap;
    }
    .compare-note{
      font-size:12px;color:var(--fg-soft);line-height:1.6;margin:0 0 10px
    }
    .compare-note b{color:var(--fg)}
    .compare-list{
      margin:0;padding-left:18px;color:var(--fg-soft);font-size:12px;line-height:1.65
    }

    footer{
      margin-top:44px;padding-top:18px;
      border-top:1px solid rgba(27,31,60,.95);
      font-size:11px;color:var(--fg-soft);
      display:flex;flex-wrap:wrap;gap:10px;
      justify-content:space-between;align-items:center;
    }
    footer nav{display:flex;gap:12px;flex-wrap:wrap}
    footer a{color:var(--fg-soft)}
    footer a:hover{color:var(--fg)}
  </style>
</head>
<body>
  <div class="page">
    <header>
      <div class="brand">
        <div class="logo-orb"><span>A2J</span></div>
        <div>
          <div class="logo-text-main">AI2JSON</div>
          <div class="logo-text-sub">Web → JSON for AI reading.</div>
        </div>
      </div>
      <nav>
        <a href="#try">Try</a>
        <a href="#value">Value</a>
        <a href="#compare">Compare</a>
        <a href="#contract">JSON</a>
        <a href="#limits">Limits</a>
        <a href="https://github.com/BACOUL/ai2json" target="_blank" rel="noopener noreferrer">GitHub</a>
        <a class="nav-cta" href="#try"><span class="dot"></span> Free sandbox</a>
      </nav>
    </header>

    <main>
      <div>
        <div class="eyebrow-row">
          <div class="eyebrow">Public sandbox</div>
          <div class="eyebrow"><span class="eyebrow-badge">AI2JSON</span> URL → JSON</div>
        </div>

        <h1><span class="highlight">AI2JSON</span> turns any public webpage into clean JSON for AI reading.</h1>

        <p class="lead">
          Most webpages are noisy: menus, footers, cookie banners, scripts. AI2JSON extracts the real content and returns a stable JSON document you can feed into LLMs and RAG pipelines.
          <b>No summary. No interpretation.</b> Just readable content + structure + a hash.
        </p>

        <div class="hero-pills">
          <div class="pill"><span class="pill-dot"></span>Extract main content</div>
          <div class="pill">Keep <code>sections[]</code> structure</div>
          <div class="pill">Deterministic output</div>
          <div class="pill">Hash for diffing</div>
        </div>

        <div class="cta-row">
          <a href="#try" class="btn">Try with a URL</a>
          <a href="#compare" class="btn-outline">See AI comparison</a>
        </div>

        <div class="hero-note">
          <span>Free. No API key.</span>
          <span>Rate-limited sandbox.</span>
          <span>Public HTTP(S) only.</span>
          <span>Spec: <b>webpage.ai.v0.1</b></span>
        </div>
      </div>

      <aside class="hero-panel" id="try">
        <div class="panel-title">Try it now (live sandbox)</div>

        <div class="field">
          <input id="url" class="input" type="url" inputmode="url" autocomplete="off"
                 placeholder="Paste a public URL (e.g. https://wikipedia.org/wiki/AI)" />
          <button id="convert" class="small-btn">Convert</button>
        </div>

        <div class="mini-row" aria-label="sandbox limits">
          <span class="mini">No API key</span>
          <span class="mini">Rate-limited</span>
          <span class="mini">Public pages only</span>
          <span class="mini">No JS rendering (v0.1)</span>
        </div>

        <div class="tabs" role="tablist" aria-label="output views">
          <span class="tab" role="tab" id="tab-json" aria-selected="true" tabindex="0">JSON</span>
          <span class="tab" role="tab" id="tab-prompt" aria-selected="false" tabindex="-1">Prompt-ready</span>
          <span class="tab" role="tab" id="tab-curl" aria-selected="false" tabindex="-1">curl</span>
          <span class="tab" role="tab" id="tab-errors" aria-selected="false" tabindex="-1">Errors</span>
        </div>

        <div class="code-window" id="out" aria-live="polite">
{
  "spec": "webpage.ai.v0.1",
  "url": "https://example.com/article",
  "canonical_url": "https://example.com/article",
  "last_fetched": "2025-01-02T10:11:12Z",
  "language": "en",
  "content_hash": "sha256:…",
  "title": "Example page title",
  "summary": "",
  "type": "article",
  "sections": [
    { "heading": null, "level": 0, "id": "content", "text": "Clean extracted content…" }
  ],
  "links": [],
  "meta": { "source": "https://example.com/article" },
  "proof": {}
}
        </div>

        <div class="panel-footer" id="panelFooter">
          For LLM usage: send <b>title</b> + <b>sections[].text</b>. Keep <b>content_hash</b> to detect changes over time.
        </div>
      </aside>
    </main>

    <section id="value">
      <div class="section-kicker">Value</div>
      <h2 class="section-title">Why JSON helps your AI more than raw HTML.</h2>
      <p class="section-sub">
        LLMs can ingest HTML, but it’s inefficient and error-prone: boilerplate dominates tokens, chunking is brittle, and “what did the model really read?” is unclear.
        AI2JSON gives you a <b>small, predictable contract</b> so your AI pipeline becomes simpler, cheaper, and easier to debug.
      </p>
      <div class="grid">
        <div class="feature">
          <h3>Less token waste</h3>
          <p>Navigation, cookie banners, and layout noise are removed so prompts are mostly <b>real content</b>.</p>
        </div>
        <div class="feature">
          <h3>Natural chunks</h3>
          <p><code>sections[]</code> are stable content blocks for prompting and RAG indexing (better than “split every N chars”).</p>
        </div>
        <div class="feature">
          <h3>Deterministic debugging</h3>
          <p>Same URL → same schema. Easier to reproduce issues vs. scraping/parsing HTML differently per project.</p>
        </div>
        <div class="feature">
          <h3>Content fingerprint</h3>
          <p><code>content_hash</code> lets you detect meaningful changes (docs/regulations/ToS) and avoid re-embedding unchanged pages.</p>
        </div>
      </div>
    </section>

    <section id="compare">
      <div class="section-kicker">Compare</div>
      <h2 class="section-title">What changes vs. “classic web reading”.</h2>
      <p class="section-sub">
        A fair comparison is not “AI can’t read HTML”. It can. The real difference is: <b>cost, reliability, and traceability</b>.
      </p>

      <div class="compare">
        <div class="compare-card">
          <div class="compare-title">
            <b>Without AI2JSON</b>
            <span>raw HTML / ad-hoc parsing</span>
          </div>
          <p class="compare-note">
            Your agent fetches a page and either dumps HTML into a prompt or implements custom parsing.
          </p>
          <ul class="compare-list">
            <li><b>Token bloat:</b> menus/footers/scripts dominate context.</li>
            <li><b>Brittle parsing:</b> every site breaks differently.</li>
            <li><b>Chunking guesswork:</b> “split by N chars” loses structure.</li>
            <li><b>Hard to prove input:</b> unclear what exact text was used later.</li>
          </ul>
        </div>

        <div class="compare-card">
          <div class="compare-title">
            <b>With AI2JSON</b>
            <span>stable JSON contract</span>
          </div>
          <p class="compare-note">
            Your agent gets <b>title + sections[]</b> in a predictable schema, plus a <b>SHA-256</b> fingerprint.
          </p>
          <ul class="compare-list">
            <li><b>Cleaner prompts:</b> content-first, less noise.</li>
            <li><b>Stable ingestion:</b> one schema across all sites.</li>
            <li><b>Better RAG:</b> sections are natural chunks for embeddings.</li>
            <li><b>Traceability:</b> store <b>content_hash</b> to prove what was read.</li>
          </ul>
        </div>
      </div>

      <div class="mono-block" style="margin-top:14px">
Prompt template (minimal)
  You are given structured page content:
  - title: {{title}}
  - sections: {{sections}}   (each has heading, level, text)
  Task: Answer using only these sections. Cite section ids when possible.

Tip
  For most use cases, only send:
    title + sections[].text
      </div>
    </section>

    <section id="contract">
      <div class="section-kicker">JSON contract</div>
      <h2 class="section-title">webpage.ai.v0.1 — minimal, predictable, AI-friendly.</h2>
      <p class="section-sub">
        This sandbox returns <b>webpage.ai.v0.1</b>. In v0.1, the payload is intentionally simple: one main section with extracted text, plus metadata and a hash.
      </p>

      <div class="table-wrap">
        <table class="table">
          <thead>
            <tr>
              <th>Field</th>
              <th>Type</th>
              <th>Meaning</th>
            </tr>
          </thead>
          <tbody>
            <tr><td><code>spec</code></td><td>string</td><td>Always <code>"webpage.ai.v0.1"</code>.</td></tr>
            <tr><td><code>url</code></td><td>string</td><td>Requested URL.</td></tr>
            <tr><td><code>canonical_url</code></td><td>string</td><td>Canonical URL (if detected).</td></tr>
            <tr><td><code>last_fetched</code></td><td>string</td><td>ISO 8601 timestamp (UTC).</td></tr>
            <tr><td><code>language</code></td><td>string/null</td><td>Best-effort language (from HTML).</td></tr>
            <tr><td><code>content_hash</code></td><td>string</td><td>SHA-256 of extracted text (prefixed <code>sha256:</code>).</td></tr>
            <tr><td><code>title</code></td><td>string</td><td>Page title.</td></tr>
            <tr><td><code>type</code></td><td>string</td><td><code>article</code> / <code>homepage</code> / <code>unknown</code>.</td></tr>
            <tr><td><code>sections[]</code></td><td>array</td><td>Ordered blocks: <code>heading</code>, <code>level</code>, <code>id</code>, <code>text</code>.</td></tr>
            <tr><td><code>meta</code></td><td>object</td><td>Best-effort metadata (v0.1: <code>source</code>).</td></tr>
          </tbody>
        </table>
      </div>

      <div class="mono-block" style="margin-top:14px">
Sandbox API (your live endpoint)
  GET https://ai2json-apiv1.jeason-bacoul.workers.dev/v1/transform?url=<ENCODED_URL>

Example
  https://ai2json-apiv1.jeason-bacoul.workers.dev/v1/transform?url=https://wikipedia.org
      </div>
    </section>

    <section id="limits">
      <div class="section-kicker">Limits & abuse protection</div>
      <h2 class="section-title">Free by default, protected by design.</h2>
      <p class="section-sub">
        This is a public sandbox. It is <b>rate-limited</b>, restricted to <b>public HTTP(S) URLs</b>, and blocks obvious private/localhost targets (basic SSRF hardening).
        Very large pages or slow upstream responses may be rejected.
      </p>

      <div class="mono-block">
Common responses (JSON)
  200  OK
  400  bad_request (missing/invalid url)
  403  forbidden (private hosts / non-http(s))
  415  unsupported_content_type (non-HTML)
  429  rate_limited (Retry-After header)
  5xx  upstream_or_internal

Notes
  - No API key in sandbox.
  - No JS rendering in v0.1 (static HTML only).
  - Best-effort extraction (some pages will be not_extractable).
      </div>

      <div class="grid" style="margin-top:16px">
        <div class="feature">
          <h3>Node.js fetch example</h3>
          <p>Store <code>content_hash</code> to skip re-processing unchanged pages.</p>
          <div class="mono-block" style="margin-top:10px">
const url = "https://wikipedia.org";
const api = "https://ai2json-apiv1.jeason-bacoul.workers.dev/v1/transform?url=" + encodeURIComponent(url);

const res = await fetch(api, { headers: { "Accept": "application/json" } });
if (!res.ok) throw new Error("HTTP " + res.status);

const doc = await res.json();
// Use in prompts / RAG:
const payload = {
  title: doc.title,
  sections: doc.sections?.map(s => ({ id: s.id, heading: s.heading, text: s.text })) ?? []
};
console.log(doc.content_hash, payload);
          </div>
        </div>
        <div class="feature">
          <h3>RAG chunking tip</h3>
          <p>Index each section separately: <code>section.id</code> is your stable reference.</p>
          <div class="mono-block" style="margin-top:10px">
chunks = sections.map(s => ({
  id: s.id,
  text: (s.heading ? (s.heading + "\n") : "") + s.text
}));

// embeddings(chunks[i].text)
// store metadata: { url, content_hash, section_id: chunks[i].id }
          </div>
        </div>
      </div>
    </section>

    <footer>
      <span>© AI2JSON — Web → JSON for AI reading.</span>
      <nav>
        <a href="https://github.com/BACOUL/ai2json" target="_blank" rel="noopener noreferrer">GitHub</a>
        <a href="#try">Try</a>
        <a href="#compare">Compare</a>
        <a href="mailto:jeason.bacoul@gmail.com">jeason.bacoul@gmail.com</a>
      </nav>
    </footer>
  </div>

  <script>
    (function(){
      const API_BASE = "https://ai2json-apiv1.jeason-bacoul.workers.dev";
      const ENDPOINT = API_BASE.replace(/\/$/,"") + "/v1/transform?url=";

      const $url = document.getElementById("url");
      const $btn = document.getElementById("convert");
      const $out = document.getElementById("out");
      const $footer = document.getElementById("panelFooter");

      const $tabJson = document.getElementById("tab-json");
      const $tabPrompt = document.getElementById("tab-prompt");
      const $tabCurl = document.getElementById("tab-curl");
      const $tabErrors = document.getElementById("tab-errors");

      let lastJson = null;
      let lastUrl = "";

      function safeText(v){ return (v == null) ? "" : String(v); }

      function renderText(text){
        $out.textContent = text;
      }
      function renderJson(obj){
        $out.textContent = JSON.stringify(obj, null, 2);
      }
      function errorObj(code, message, extra){
        const o = { error: { code: code, message: message } };
        if(extra && typeof extra === "object") for(const k in extra) o[k] = extra[k];
        return o;
      }

      function setTab(selected){
        const tabs = [$tabJson,$tabPrompt,$tabCurl,$tabErrors];
        for(const t of tabs){
          const on = (t === selected);
          t.setAttribute("aria-selected", on ? "true" : "false");
          t.tabIndex = on ? 0 : -1;
        }
      }

      function viewJson(){
        setTab($tabJson);
        if(lastJson) renderJson(lastJson);
        else renderText("Paste a URL and click Convert.");
        $footer.innerHTML = 'For LLM usage: send <b>title</b> + <b>sections[].text</b>. Keep <b>content_hash</b> to detect changes over time.';
      }

      function viewPrompt(){
        setTab($tabPrompt);
        if(!lastJson){
          renderText("Convert a URL first, then switch to Prompt-ready.");
          return;
        }
        const title = safeText(lastJson.title || "");
        const sections = Array.isArray(lastJson.sections) ? lastJson.sections : [];
        const lines = [];
        lines.push("SYSTEM: You are given structured webpage content. Use ONLY this content.");
        lines.push("");
        lines.push("TITLE:");
        lines.push(title || "(no title)");
        lines.push("");
        lines.push("SECTIONS:");
        for(const s of sections){
          const id = safeText(s && s.id);
          const h = (s && s.heading != null) ? safeText(s.heading) : "";
          const txt = safeText(s && s.text);
          lines.push("- id: " + (id || "content"));
          if(h) lines.push("  heading: " + h);
          lines.push("  text: " + txt);
          lines.push("");
        }
        lines.push("TASK: Answer the user's question using only the sections above. If you cite, mention section ids.");
        renderText(lines.join("\n"));
        $footer.innerHTML = 'Prompt-ready view: copy this into your agent/tool call. Keep <b>content_hash</b> for traceability.';
      }

      function viewCurl(){
        setTab($tabCurl);
        const u = lastUrl || safeText($url.value).trim() || "https://wikipedia.org";
        const full = ENDPOINT + encodeURIComponent(u);
        renderText('curl "' + full + '" -H "Accept: application/json"');
        $footer.innerHTML = 'curl view: simplest way to test without any SDK.';
      }

      function viewErrors(){
        setTab($tabErrors);
        renderText([
          "Error examples (JSON):",
          "",
          "400 bad_request",
          JSON.stringify({ error: { code: "bad_request", message: "Missing \"url\" query parameter." } }, null, 2),
          "",
          "403 forbidden",
          JSON.stringify({ error: { code: "forbidden", message: "Target host is not allowed." } }, null, 2),
          "",
          "429 rate_limited",
          JSON.stringify({ error: { code: "rate_limited", message: "Too many requests. Try again shortly." }, retry_after_seconds: 10 }, null, 2),
          "",
          "415 unsupported_content_type",
          JSON.stringify({ error: { code: "unsupported_content_type", message: "Only HTML pages are supported in v0.1." } }, null, 2)
        ].join("\n"));
        $footer.innerHTML = 'Errors view: build robust clients. For 429, read <b>Retry-After</b>.';
      }

      async function run(){
        const raw = safeText($url.value).trim();
        if(!raw){
          lastJson = null;
          lastUrl = "";
          viewJson();
          renderJson(errorObj("missing_url","Paste a public URL to convert."));
          return;
        }

        let u;
        try { u = new URL(raw); }
        catch {
          lastJson = null; lastUrl = raw;
          viewJson();
          renderJson(errorObj("invalid_url","Invalid URL format."));
          return;
        }
        if(u.protocol !== "http:" && u.protocol !== "https:"){
          lastJson = null; lastUrl = raw;
          viewJson();
          renderJson(errorObj("invalid_url","URL must start with http(s)."));
          return;
        }

        $btn.disabled = true;
        $btn.textContent = "Converting…";

        lastUrl = raw;
        lastJson = null;
        viewJson();
        renderJson({ status: "fetching", url: raw });

        try{
          const endpoint = ENDPOINT + encodeURIComponent(raw);
          const res = await fetch(endpoint, { method: "GET", headers: { "Accept":"application/json" } });
          const ct = res.headers.get("content-type") || "";

          let data = null;
          if(ct.includes("application/json")){
            data = await res.json();
          }else{
            const text = await res.text();
            data = errorObj("bad_response","Expected JSON but received non-JSON.", { excerpt: safeText(text).slice(0, 220) });
          }

          if(!res.ok){
            const retryAfter = res.headers.get("retry-after");
            const out = Object.assign({ http_status: res.status }, (data || errorObj("error","Request failed.")));
            if(retryAfter) out.retry_after = retryAfter;
            renderJson(out);
          }else{
            lastJson = data;
            renderJson(data);
          }
        }catch(e){
          renderJson(errorObj("network_error", safeText(e && e.message ? e.message : e)));
        }finally{
          $btn.disabled = false;
          $btn.textContent = "Convert";
        }
      }

      function onTabClick(tab){
        if(tab === $tabJson) return viewJson();
        if(tab === $tabPrompt) return viewPrompt();
        if(tab === $tabCurl) return viewCurl();
        if(tab === $tabErrors) return viewErrors();
      }

      [$tabJson,$tabPrompt,$tabCurl,$tabErrors].forEach(tab=>{
        tab.addEventListener("click", ()=>onTabClick(tab));
        tab.addEventListener("keydown",(e)=>{
          if(e.key === "Enter" || e.key === " "){ e.preventDefault(); onTabClick(tab); }
        });
      });

      $btn.addEventListener("click", run);
      $url.addEventListener("keydown", (e)=>{ if(e.key === "Enter") run(); });

      // default view
      viewJson();
    })();
  </script>
</body>
</html>
